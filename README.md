# KnxCached
## PRE-VERSION
Linux daemon, manage a cache to Knx object, and provide a SCPI interface to managed objects.

# Requirement
This daemon need knxd (libeibclient.so need to build, and knxd daemon need at runtime)

# Compile
```bash
mkdir build
cd build
cmake ..
make
```

# Principle, and difference with linknx
It can be compared to linknx project, but, the goal of this one is to use a more simple programming approach.  
knxcached only depends to libeibclient; it is writing in a pure c++11 and only for linux.  
It's goal is only a object proxy; it doesn't do data logging or rules.  
For this tasks, there will be another daemon connected to knxcached.  
The first will be knxlogerd, in order to store all change in a database.  
The second will be knxruled; in order to write rules a QML language (QML binding is a very good approach to write rules).  
All the configuration will be in sources files; not in database, and not generated by a web interface.  
It can be used with tool like git.

# Usage
First, you need to generate a configuration file.  
This is a knxcached.xml file like:  
```xml
<?xml version='1.0' encoding='UTF-8'?>
<knxcached>
  <knxd url="ip:127.0.0.1"/>
  <object type="1.011" gad="1/5/37" id="Light_Status_Bedroom"/>
  <object type="1.001" gad="1/1/37" id="Light_Switch_Bedroom"/>
</knxcached>
```

This file must be in the same folder as knxcached binary (for now, but, when this project will be ready, a start script (systemd/sysv), and different location for this config file will be availlable (like /etc/)).  
You can generate directly this config file by runing:
```bash
./GenConfig.py MyProject.knxproj  > /etc/knxcached.xml
```
Then, you can start knxcached by running ./knxcached or print all command option by ./knxcached --help

# Clients
This daemon can be used throw SCPI command on port 6721:
telnet 127.0.0.1 6721
#> listen Light_Switch_Bedroom


# SCPI command
Curently, supported commands are:

>*idn?

"KnxCached",0,0,1.0

Return the current daemon version

>exit

Close client connection

>list?

List all knx object:
X/X/X ID

>values?

Show value for all knx object:
ID: value

>listen?

Show all listened object

>listen <* | ID | GAD>

Add a listner to an object
You can use ID or GAD to identify an object
\* can be use in debug to show all event


>mode <datetext | b64 | text>

Use to select the way object will be send when listened (not yet implemented)

>set <NAME> <VALUE>

Set value of an object (and send a write command on bus)
